# Default target
default:
    @just --list

# Define architectures and output dirs
# archs := ["x86_64-unknown-linux-gnu", "aarch64-unknown-linux-gnu"]

# Build for host (macOS arm64 → Darwin)
build-host:
    echo "🏗️  Building for host (macOS arm64)..."
    cargo build --release --target aarch64-apple-darwin
    mkdir -p bin/aarch64-apple-darwin
    cp target/aarch64-apple-darwin/release/wget_demo bin/aarch64-apple-darwin/

# Build for Raspberry Pi (64-bit)
build-rpi:
    echo "🏗️  Building for Raspberry Pi (aarch64-linux-gnu)..."
    rustup target add aarch64-unknown-linux-gnu
    cargo build --release --target aarch64-unknown-linux-gnu
    mkdir -p bin/aarch64-unknown-linux-gnu
    cp target/aarch64-unknown-linux-gnu/release/wget_demo bin/aarch64-unknown-linux-gnu/

# Build for x86_64 Linux
build-linux:
    echo "🏗️  Building for x86_64 Linux..."
    rustup target add x86_64-unknown-linux-gnu
    cargo build --release --target x86_64-unknown-linux-gnu
    mkdir -p bin/x86_64-unknown-linux-gnu
    cp target/x86_64-unknown-linux-gnu/release/wget_demo bin/x86_64-unknown-linux-gnu/

# Build all
build-all:
    @just build-host
    @just build-linux
    @just build-rpi

# Clean build outputs
clean:
    cargo clean
    rm -rf bin
